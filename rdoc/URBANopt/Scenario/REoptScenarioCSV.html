<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class URBANopt::Scenario::REoptScenarioCSV - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/navigation.js" defer></script>
<script src="../../js/search.js" defer></script>
<script src="../../js/search_index.js" defer></script>
<script src="../../js/searcher.js" defer></script>
<script src="../../js/darkfish.js" defer></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">
<link href="../../custom_rdoc_styles.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">ScenarioCSV
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li class="calls-super" ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-simulation_dirs">#simulation_dirs</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-URBANopt::Scenario::REoptScenarioCSV">
  <h1 id="class-URBANopt::Scenario::REoptScenarioCSV" class="class">
    class URBANopt::Scenario::REoptScenarioCSV
  </h1>

  <section class="description">
    
  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-reopt_feature_assumptions" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">reopt_feature_assumptions</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p><em>Array</em> List of paths to .json files containing /REopt Lite assumptions for feature reports ordered by feature order. See <a href="https://developer.nrel.gov/docs/energy-optimization/reopt-v1">developer.nrel.gov/docs/energy-optimization/reopt-v1</a> for more info on REopt Lite input formatting requirements.</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(name, root_dir, run_dir, feature_file, mapper_files_dir, csv_file, num_header_rows, reopt_files_dir=nil, scenario_reopt_assumptions_file_name=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p><a href="REoptScenarioCSV.html"><code>REoptScenarioCSV</code></a> is a <a href="ScenarioCSV.html"><code>ScenarioCSV</code></a> which assigns a Simulation Mapper to each Feature in a FeatureFile using a simple CSV format. The CSV file has three columns 1) feature_id, 2) feature_name, and 3) mapper_class_name. There is one row for each Feature. <a href="REoptScenarioCSV.html"><code>REoptScenarioCSV</code></a> also maps REopt Lite assumptions to the scenario for an optimization at the aggregated level, and to each feature from the CS for more localized optimizations. REopt Lite assumptions must be formatted as valid JSON&#39;s and stored in a common directory.</p>

<p>[parameters:] <code>name</code> - <em>String</em> - Human readable scenario name.<br> <code>root_dir</code> - <em>String</em> - Root directory for the scenario, contains Gemfile describing dependencies.<br> <code>run_dir</code> - <em>String</em> - Directory for simulation of this scenario, deleting run directory clears the scenario.<br> <code>feature_file</code> - <em>URBANopt::Core::FeatureFile</em> - FeatureFile containing features to simulate.<br> <code>mapper_files_dir</code> - <em>String</em> - Directory containing all mapper class files containing MapperBase definitions.<br> <code>csv_file</code> - <em>String</em> - Path to CSV file assigning a MapperBase class to each feature in feature_file.<br> <code>num_header_rows</code> - <em>Strng</em> - Number of header rows to skip in CSV file.<br> <code>reopt_files_dir</code> - <em>Strng</em> - Optional. Path to folder containing default REopt Lite assumptions .json files.<br> <code>scenario_reopt_assumptions_file_name</code> - <em>Strng</em> - Optional. Name of a .json file in the reopt_files_dir location to use in assessing the <a href="../Scenario.html"><code>Scenario</code></a> Report in REopt Lite at the aggregated level.</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/urbanopt/reopt/scenario/reopt_scenario_csv.rb, line 58</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">root_dir</span>, <span class="ruby-identifier">run_dir</span>, <span class="ruby-identifier">feature_file</span>, <span class="ruby-identifier">mapper_files_dir</span>, <span class="ruby-identifier">csv_file</span>, <span class="ruby-identifier">num_header_rows</span>, <span class="ruby-identifier">reopt_files_dir</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">scenario_reopt_assumptions_file_name</span>=<span class="ruby-keyword">nil</span>)

  <span class="ruby-keyword">super</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">root_dir</span>, <span class="ruby-identifier">run_dir</span>, <span class="ruby-identifier">feature_file</span>, <span class="ruby-identifier">mapper_files_dir</span>, <span class="ruby-identifier">csv_file</span>, <span class="ruby-identifier">num_header_rows</span>)

  <span class="ruby-ivar">@reopt_files_dir</span> = <span class="ruby-identifier">reopt_files_dir</span>
  <span class="ruby-ivar">@reopt_feature_assumptions</span> = []
  <span class="ruby-ivar">@scenario_reopt_assumptions_file</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">reopt_files_dir</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">scenario_reopt_assumptions_file_name</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-ivar">@scenario_reopt_assumptions_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@reopt_files_dir</span>, <span class="ruby-identifier">scenario_reopt_assumptions_file_name</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-simulation_dirs" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">simulation_dirs</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets all the simulation directories</p>
          
          

          
          <div class="method-source-code" id="simulation_dirs-source">
            <pre><span class="ruby-comment"># File lib/urbanopt/reopt/scenario/reopt_scenario_csv.rb, line 80</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">simulation_dirs</span>
  <span class="ruby-comment"># DLM: TODO use HeaderConverters from CSV module</span>
  <span class="ruby-identifier">rows_skipped</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">result</span> = []
  <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">foreach</span>(<span class="ruby-ivar">@csv_file</span>).<span class="ruby-identifier">with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span>, <span class="ruby-identifier">idx</span><span class="ruby-operator">|</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">rows_skipped</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@num_header_rows</span>
      <span class="ruby-identifier">rows_skipped</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">row</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">nil?</span>

    <span class="ruby-comment"># gets +feature_id+ , +feature_name+ and +mapper_class+ from csv_file</span>
    <span class="ruby-identifier">feature_id</span> = <span class="ruby-identifier">row</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">chomp</span>
    <span class="ruby-identifier">feature_name</span> = <span class="ruby-identifier">row</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">chomp</span>
    <span class="ruby-identifier">mapper_class</span> = <span class="ruby-identifier">row</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">chomp</span>
    <span class="ruby-comment">#Assume fourth columns, if exists, contains the name of the JSON file in the reopt_files_dir to use when running REopt Lite for the feature report</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span>
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@reopt_files_dir</span>.<span class="ruby-identifier">nil?</span>
        <span class="ruby-ivar">@reopt_feature_assumptions</span>[<span class="ruby-identifier">idx</span><span class="ruby-value">-1</span>] = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@reopt_files_dir</span>,<span class="ruby-identifier">row</span>[<span class="ruby-value">3</span>].<span class="ruby-identifier">chomp</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># gets +features+ from the feature_file.</span>
    <span class="ruby-identifier">features</span> = []
    <span class="ruby-identifier">feature</span> = <span class="ruby-identifier">feature_file</span>.<span class="ruby-identifier">get_feature_by_id</span>(<span class="ruby-identifier">feature_id</span>)
    <span class="ruby-identifier">features</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">feature</span>

    <span class="ruby-identifier">feature_names</span> = []
    <span class="ruby-identifier">feature_names</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">feature_name</span>
    <span class="ruby-identifier">simulation_dir</span> = <span class="ruby-constant">SimulationDirOSW</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">features</span>, <span class="ruby-identifier">feature_names</span>, <span class="ruby-identifier">mapper_class</span>)

    <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">simulation_dir</span>

  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

